-- Usecase 1

-- Make user.
insert into User
values ("olanordmann", "Ola", "Nordmann", "ola@nordmann.no", "12345", "student");

-- Check credentials.
select UserID, Password
from User
where Email = "ola@nordmann.no";

-- Show result from making user.
select * from User;


-- Add data to statistics.
insert into ActiveOnDate
values("olanordmann", "2020-03-11");

-- Show statistics result.
select * from ActiveOnDate;

-- Usecase 2

-- Make one course.
insert into Course
values ("TDT4145", "Databases", "spring", 1);

-- Make one instructor.
insert into User
values ("roger", "Roger", "Midt", "roger@midt.no", "admin", "instructor");

-- Make folder.
insert into Folder
values (1, "Exam", "TDT4145", NULL, "roger");

-- Create post.
insert into Post
values (1, "This is my first post, in usecase 2. Yes sir!", "thread", "olanordmann");

-- Add post to Thread as well.
insert into Thread
values (1, "First post ever!", "red", "question", 1); 

-- Show results. 
select * from Course;
select * from User;
select * from Folder;
select * from Post;
select * from Thread;

-- Add data for statistics.
insert into ActiveOnDate
values("olanordmann", "2020-03-12"); -- Change date to 12.03.2020 to check functionality for that as well. 

insert into ViewedBy
values("olanordmann", 1);

-- Check tables.
select * from ActiveOnDate;
select * from ViewedBy;

-- Usecase 3

-- Instructor "roger" replies to post 1 from usecase 2.
insert into Post
values (2, "Reply to first post", "reply", "roger"); 

insert into Reply -- This does not match anymore. 
values (2, NULL, 1);

-- Show results.
select * from Post;
select * from Reply; -- This does not match anymore. 

-- Add data for statistics.
insert into ActiveOnDate
values("roger", "2020-03-12");  

insert into ViewedBy
values("roger", 1);
values("roger", 2);

-- Check tables.
select * from ActiveOnDate;
select * from ViewedBy;

-- Usecase 4

-- Search for keyword in Post and return list (of IDs).
select * 
from Post
where Text LIKE "%WAL%";

-- Construct new post with the given keyword. 
insert into Post
values (3, "Post to check keyword. The keyword we are looking for is inWALside this word", "thread", "olanordmann");

-- Query again.
select *
from Post
where Text LIKE "%WAL%";

-- Add data for statistics.
-- I assume that the student is searching for this on the same day as earlier, hence nothing is added. 

-- Usecase 5: Statistics.
select UserID, COUNT(ViewedBy.PostID) as Read, COUNT(PostID) as Created 
from ViewedBy right outer join User on (UserID == UserID) left outer join Post on (UserID == UserID) 
group by UserID;
